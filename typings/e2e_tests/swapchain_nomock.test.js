"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const e2etestlib_1 = require("./e2etestlib");
const api_1 = require("src/apis/keystore/api");
const bn_js_1 = __importDefault(require("bn.js"));
describe("SwapChain", () => {
    let tx = { value: "" };
    let asset = { value: "" };
    let addrB = { value: "" };
    let addrC = { value: "" };
    const axia = (0, e2etestlib_1.getAxia)();
    const swapchain = axia.SwapChain();
    const keystore = new api_1.KeystoreAPI(axia);
    const user = "axiaJsSwapChainUser";
    const passwd = "axiaJsP1ssw4rd";
    const badUser = "asdfasdfsa";
    const badPass = "pass";
    const memo = "hello world";
    const whaleAddr = "Swap-custom18jma8ppw3nhx5r4ap8clazz0dps7rv5u9xde7p";
    const key = "PrivateKey-ewoqjP7PxY4yr3iLTpLisriqt94hdyDFNgchSxGGztUrTXtNN";
    // test_name        response_promise                            resp_fn          matcher           expected_value/obtained_value
    const tests_spec = [
        [
            "createUser",
            () => keystore.createUser(user, passwd),
            (x) => x,
            e2etestlib_1.Matcher.toBe,
            () => true
        ],
        [
            "createaddrB",
            () => swapchain.createAddress(user, passwd),
            (x) => x,
            e2etestlib_1.Matcher.Get,
            () => addrB
        ],
        [
            "createaddrB",
            () => swapchain.createAddress(user, passwd),
            (x) => x,
            e2etestlib_1.Matcher.Get,
            () => addrC
        ],
        [
            "incorrectUser",
            () => swapchain.send(badUser, passwd, "AXC", 10, addrB.value, [addrC.value], addrB.value, memo),
            (x) => x,
            e2etestlib_1.Matcher.toThrow,
            () => `problem retrieving user "${badUser}": incorrect password for user "${badUser}"`
        ],
        [
            "incorrectPass",
            () => swapchain.send(user, badPass, "AXC", 10, addrB.value, [addrC.value], addrB.value, memo),
            (x) => x,
            e2etestlib_1.Matcher.toThrow,
            () => `problem retrieving user "${user}": incorrect password for user "${user}"`
        ],
        [
            "getBalance",
            () => swapchain.getBalance(whaleAddr, "AXC"),
            (x) => x.balance,
            e2etestlib_1.Matcher.toBe,
            () => "300000000000000000"
        ],
        [
            "getBalance2",
            () => swapchain.getBalance(whaleAddr, "AXC"),
            (x) => x.utxoIDs[0].txID,
            e2etestlib_1.Matcher.toBe,
            () => "BUuypiq2wyuLMvyhzFXcPyxPMCgSp7eeDohhQRqTChoBjKziC"
        ],
        [
            "importKey",
            () => swapchain.importKey(user, passwd, key),
            (x) => x,
            e2etestlib_1.Matcher.toBe,
            () => whaleAddr
        ],
        [
            "send",
            () => swapchain.send(user, passwd, "AXC", 10, addrB.value, [whaleAddr], whaleAddr, memo),
            (x) => x.txID,
            e2etestlib_1.Matcher.Get,
            () => tx
        ],
        [
            "sendMultiple",
            () => swapchain.sendMultiple(user, passwd, [
                { assetID: "AXC", amount: 10, to: addrB.value },
                { assetID: "AXC", amount: 20, to: addrC.value }
            ], [whaleAddr], whaleAddr, memo),
            (x) => x.txID,
            e2etestlib_1.Matcher.Get,
            () => tx
        ],
        [
            "listAddrs",
            () => swapchain.listAddresses(user, passwd),
            (x) => x.sort(),
            e2etestlib_1.Matcher.toEqual,
            () => [whaleAddr, addrB.value, addrC.value].sort()
        ],
        [
            "exportKey",
            () => swapchain.exportKey(user, passwd, addrB.value),
            (x) => x,
            e2etestlib_1.Matcher.toMatch,
            () => /PrivateKey-\w*/
        ],
        [
            "export",
            () => swapchain.export(user, passwd, "AX" + addrB.value.substring(1), new bn_js_1.default(10), "AXC"),
            (x) => x,
            e2etestlib_1.Matcher.toThrow,
            () => "couldn't unmarshal an argument"
        ],
        [
            "import",
            () => swapchain.import(user, passwd, addrB.value, "Core"),
            (x) => x,
            e2etestlib_1.Matcher.toThrow,
            () => "problem issuing transaction: no import inputs"
        ],
        [
            "createFixed",
            () => swapchain.createFixedCapAsset(user, passwd, "Some Coin", "SCC", 0, [
                { address: whaleAddr, amount: "10000" }
            ]),
            (x) => x,
            e2etestlib_1.Matcher.Get,
            () => asset
        ],
        [
            "createVar",
            () => swapchain.createVariableCapAsset(user, passwd, "Some Coin", "SCC", 0, [
                { minters: [whaleAddr], threshold: 1 }
            ]),
            (x) => x,
            e2etestlib_1.Matcher.Get,
            () => asset
        ],
        [
            "mint",
            () => swapchain.mint(user, passwd, 1500, asset.value, addrB.value, [whaleAddr]),
            (x) => x,
            e2etestlib_1.Matcher.toThrow,
            () => "couldn't unmarshal an argument"
        ],
        [
            "getTx",
            () => swapchain.getTx(tx.value),
            (x) => x,
            e2etestlib_1.Matcher.toMatch,
            () => /\w+/
        ],
        [
            "getTxStatus",
            () => swapchain.getTxStatus(tx.value),
            (x) => x,
            e2etestlib_1.Matcher.toBe,
            () => "Processing"
        ],
        [
            "getAssetDesc",
            () => swapchain.getAssetDescription(asset.value),
            (x) => [x.name, x.symbol],
            e2etestlib_1.Matcher.toEqual,
            () => ["Some Coin", "SCC"]
        ]
    ];
    (0, e2etestlib_1.createTests)(tests_spec);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3dhcGNoYWluX25vbW9jay50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vZTJlX3Rlc3RzL3N3YXBjaGFpbl9ub21vY2sudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLDZDQUE0RDtBQUM1RCwrQ0FBbUQ7QUFDbkQsa0RBQXNCO0FBRXRCLFFBQVEsQ0FBQyxXQUFXLEVBQUUsR0FBUyxFQUFFO0lBQy9CLElBQUksRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFBO0lBQ3RCLElBQUksS0FBSyxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFBO0lBQ3pCLElBQUksS0FBSyxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFBO0lBQ3pCLElBQUksS0FBSyxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFBO0lBRXpCLE1BQU0sSUFBSSxHQUFHLElBQUEsb0JBQU8sR0FBRSxDQUFBO0lBQ3RCLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQTtJQUNsQyxNQUFNLFFBQVEsR0FBRyxJQUFJLGlCQUFXLENBQUMsSUFBSSxDQUFDLENBQUE7SUFFdEMsTUFBTSxJQUFJLEdBQVcscUJBQXFCLENBQUE7SUFDMUMsTUFBTSxNQUFNLEdBQVcsZ0JBQWdCLENBQUE7SUFDdkMsTUFBTSxPQUFPLEdBQVcsWUFBWSxDQUFBO0lBQ3BDLE1BQU0sT0FBTyxHQUFXLE1BQU0sQ0FBQTtJQUM5QixNQUFNLElBQUksR0FBVyxhQUFhLENBQUE7SUFDbEMsTUFBTSxTQUFTLEdBQVcsb0RBQW9ELENBQUE7SUFDOUUsTUFBTSxHQUFHLEdBQ1AsOERBQThELENBQUE7SUFFaEUsZ0lBQWdJO0lBQ2hJLE1BQU0sVUFBVSxHQUFRO1FBQ3RCO1lBQ0UsWUFBWTtZQUNaLEdBQUcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQztZ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QUFFLENBQ0gsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUMzRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNSLG9CQUFPLENBQUMsT0FBTztZQUNmLEdBQUcsRUFBRSxDQUFDLGdDQUFnQztTQUN2QztRQUNEO1lBQ0UsT0FBTztZQUNQLEdBQUcsRUFBRSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQztZQUMvQixDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNSLG9CQUFPLENBQUMsT0FBTztZQUNmLEdBQUcsRUFBRSxDQUFDLEtBQUs7U0FDWjtRQUNEO1lBQ0UsYUFBYTtZQUNiLEdBQUcsRUFBRSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQztZQUNyQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNSLG9CQUFPLENBQUMsSUFBSTtZQUNaLEdBQUcsRUFBRSxDQUFDLFlBQVk7U0FDbkI7UUFDRDtZQUNFLGNBQWM7WUFDZCxHQUFHLEVBQUUsQ0FBQyxTQUFTLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQztZQUNoRCxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUM7WUFDekIsb0JBQU8sQ0FBQyxPQUFPO1lBQ2YsR0FBRyxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUsS0FBSyxDQUFDO1NBQzNCO0tBQ0YsQ0FBQTtJQUVELElBQUEsd0JBQVcsRUFBQyxVQUFVLENBQUMsQ0FBQTtBQUN6QixDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldEF4aWEsIGNyZWF0ZVRlc3RzLCBNYXRjaGVyIH0gZnJvbSBcIi4vZTJldGVzdGxpYlwiXG5pbXBvcnQgeyBLZXlzdG9yZUFQSSB9IGZyb20gXCJzcmMvYXBpcy9rZXlzdG9yZS9hcGlcIlxuaW1wb3J0IEJOIGZyb20gXCJibi5qc1wiXG5cbmRlc2NyaWJlKFwiU3dhcENoYWluXCIsICgpOiB2b2lkID0+IHtcbiAgbGV0IHR4ID0geyB2YWx1ZTogXCJcIiB9XG4gIGxldCBhc3NldCA9IHsgdmFsdWU6IFwiXCIgfVxuICBsZXQgYWRkckIgPSB7IHZhbHVlOiBcIlwiIH1cbiAgbGV0IGFkZHJDID0geyB2YWx1ZTogXCJcIiB9XG5cbiAgY29uc3QgYXhpYSA9IGdldEF4aWEoKVxuICBjb25zdCBzd2FwY2hhaW4gPSBheGlhLlN3YXBDaGFpbigpXG4gIGNvbnN0IGtleXN0b3JlID0gbmV3IEtleXN0b3JlQVBJKGF4aWEpXG5cbiAgY29uc3QgdXNlcjogc3RyaW5nID0gXCJheGlhSnNTd2FwQ2hhaW5Vc2VyXCJcbiAgY29uc3QgcGFzc3dkOiBzdHJpbmcgPSBcImF4aWFKc1Axc3N3NHJkXCJcbiAgY29uc3QgYmFkVXNlcjogc3RyaW5nID0gXCJhc2RmYXNkZnNhXCJcbiAgY29uc3QgYmFkUGFzczogc3RyaW5nID0gXCJwYXNzXCJcbiAgY29uc3QgbWVtbzogc3RyaW5nID0gXCJoZWxsbyB3b3JsZFwiXG4gIGNvbnN0IHdoYWxlQWRkcjogc3RyaW5nID0gXCJTd2FwLWN1c3RvbTE4am1hOHBwdzNuaHg1cjRhcDhjbGF6ejBkcHM3cnY1dTl4ZGU3cFwiXG4gIGNvbnN0IGtleTogc3RyaW5nID1cbiAgICBcIlByaXZhdGVLZXktZXdvcWpQN1B4WTR5cjNpTFRwTGlzcmlxdDk0aGR5REZOZ2NoU3hHR3p0VXJUWHROTlwiXG5cbiAgLy8gdGVzdF9uYW1lICAgICAgICByZXNwb25zZV9wcm9taXNlICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BfZm4gICAgICAgICAgbWF0Y2hlciAgICAgICAgICAgZXhwZWN0ZWRfdmFsdWUvb2J0YWluZWRfdmFsdWVcbiAgY29uc3QgdGVzdHNfc3BlYzogYW55ID0gW1xuICAgIFtcbiAgICAgIFwiY3JlYXRlVXNlclwiLFxuICAgICAgKCkgPT4ga2V5c3RvcmUuY3JlYXRlVXNlcih1c2VyLCBwYXNzd2QpLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLnRvQmUsXG4gICAgICAoKSA9PiB0cnVlXG4gICAgXSxcbiAgICBbXG4gICAgICBcImNyZWF0ZWFkZHJCXCIsXG4gICAgICAoKSA9PiBzd2FwY2hhaW4uY3JlYXRlQWRkcmVzcyh1c2VyLCBwYXNzd2QpLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLkdldCxcbiAgICAgICgpID0+IGFkZHJCXG4gICAgXSxcbiAgICBbXG4gICAgICBcImNyZWF0ZWFkZHJCXCIsXG4gICAgICAoKSA9PiBzd2FwY2hhaW4uY3JlYXRlQWRkcmVzcyh1c2VyLCBwYXNzd2QpLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLkdldCxcbiAgICAgICgpID0+IGFkZHJDXG4gICAgXSxcbiAgICBbXG4gICAgICBcImluY29ycmVjdFVzZXJcIixcbiAgICAgICgpID0+XG4gICAgICAgIHN3YXBjaGFpbi5zZW5kKFxuICAgICAgICAgIGJhZFVzZXIsXG4gICAgICAgICAgcGFzc3dkLFxuICAgICAgICAgIFwiQVhDXCIsXG4gICAgICAgICAgMTAsXG4gICAgICAgICAgYWRkckIudmFsdWUsXG4gICAgICAgICAgW2FkZHJDLnZhbHVlXSxcbiAgICAgICAgICBhZGRyQi52YWx1ZSxcbiAgICAgICAgICBtZW1vXG4gICAgICAgICksXG4gICAgICAoeCkgPT4geCxcbiAgICAgIE1hdGNoZXIudG9UaHJvdyxcbiAgICAgICgpID0+IGBwcm9ibGVtIHJldHJpZXZpbmcgdXNlciBcIiR7YmFkVXNlcn1cIjogaW5jb3JyZWN0IHBhc3N3b3JkIGZvciB1c2VyIFwiJHtiYWRVc2VyfVwiYFxuICAgIF0sXG4gICAgW1xuICAgICAgXCJpbmNvcnJlY3RQYXNzXCIsXG4gICAgICAoKSA9PlxuICAgICAgICBzd2FwY2hhaW4uc2VuZChcbiAgICAgICAgICB1c2VyLFxuICAgICAgICAgIGJhZFBhc3MsXG4gICAgICAgICAgXCJBWENcIixcbiAgICAgICAgICAxMCxcbiAgICAgICAgICBhZGRyQi52YWx1ZSxcbiAgICAgICAgICBbYWRkckMudmFsdWVdLFxuICAgICAgICAgIGFkZHJCLnZhbHVlLFxuICAgICAgICAgIG1lbW9cbiAgICAgICAgKSxcbiAgICAgICh4KSA9PiB4LFxuICAgICAgTWF0Y2hlci50b1Rocm93LFxuICAgICAgKCkgPT4gYHByb2JsZW0gcmV0cmlldmluZyB1c2VyIFwiJHt1c2VyfVwiOiBpbmNvcnJlY3QgcGFzc3dvcmQgZm9yIHVzZXIgXCIke3VzZXJ9XCJgXG4gICAgXSxcbiAgICBbXG4gICAgICBcImdldEJhbGFuY2VcIixcbiAgICAgICgpID0+IHN3YXBjaGFpbi5nZXRCYWxhbmNlKHdoYWxlQWRkciwgXCJBWENcIiksXG4gICAgICAoeCkgPT4geC5iYWxhbmNlLFxuICAgICAgTWF0Y2hlci50b0JlLFxuICAgICAgKCkgPT4gXCIzMDAwMDAwMDAwMDAwMDAwMDBcIlxuICAgIF0sXG4gICAgW1xuICAgICAgXCJnZXRCYWxhbmNlMlwiLFxuICAgICAgKCkgPT4gc3dhcGNoYWluLmdldEJhbGFuY2Uod2hhbGVBZGRyLCBcIkFYQ1wiKSxcbiAgICAgICh4KSA9PiB4LnV0eG9JRHNbMF0udHhJRCxcbiAgICAgIE1hdGNoZXIudG9CZSxcbiAgICAgICgpID0+IFwiQlV1eXBpcTJ3eXVMTXZ5aHpGWGNQeXhQTUNnU3A3ZWVEb2hoUVJxVENob0JqS3ppQ1wiXG4gICAgXSxcbiAgICBbXG4gICAgICBcImltcG9ydEtleVwiLFxuICAgICAgKCkgPT4gc3dhcGNoYWluLmltcG9ydEtleSh1c2VyLCBwYXNzd2QsIGtleSksXG4gICAgICAoeCkgPT4geCxcbiAgICAgIE1hdGNoZXIudG9CZSxcbiAgICAgICgpID0+IHdoYWxlQWRkclxuICAgIF0sXG4gICAgW1xuICAgICAgXCJzZW5kXCIsXG4gICAgICAoKSA9PlxuICAgICAgICBzd2FwY2hhaW4uc2VuZChcbiAgICAgICAgICB1c2VyLFxuICAgICAgICAgIHBhc3N3ZCxcbiAgICAgICAgICBcIkFYQ1wiLFxuICAgICAgICAgIDEwLFxuICAgICAgICAgIGFkZHJCLnZhbHVlLFxuICAgICAgICAgIFt3aGFsZUFkZHJdLFxuICAgICAgICAgIHdoYWxlQWRkcixcbiAgICAgICAgICBtZW1vXG4gICAgICAgICksXG4gICAgICAoeCkgPT4geC50eElELFxuICAgICAgTWF0Y2hlci5HZXQsXG4gICAgICAoKSA9PiB0eFxuICAgIF0sXG4gICAgW1xuICAgICAgXCJzZW5kTXVsdGlwbGVcIixcbiAgICAgICgpID0+XG4gICAgICAgIHN3YXBjaGFpbi5zZW5kTXVsdGlwbGUoXG4gICAgICAgICAgdXNlcixcbiAgICAgICAgICBwYXNzd2QsXG4gICAgICAgICAgW1xuICAgICAgICAgICAgeyBhc3NldElEOiBcIkFYQ1wiLCBhbW91bnQ6IDEwLCB0bzogYWRkckIudmFsdWUgfSxcbiAgICAgICAgICAgIHsgYXNzZXRJRDogXCJBWENcIiwgYW1vdW50OiAyMCwgdG86IGFkZHJDLnZhbHVlIH1cbiAgICAgICAgICBdLFxuICAgICAgICAgIFt3aGFsZUFkZHJdLFxuICAgICAgICAgIHdoYWxlQWRkcixcbiAgICAgICAgICBtZW1vXG4gICAgICAgICksXG4gICAgICAoeCkgPT4geC50eElELFxuICAgICAgTWF0Y2hlci5HZXQsXG4gICAgICAoKSA9PiB0eFxuICAgIF0sXG4gICAgW1xuICAgICAgXCJsaXN0QWRkcnNcIixcbiAgICAgICgpID0+IHN3YXBjaGFpbi5saXN0QWRkcmVzc2VzKHVzZXIsIHBhc3N3ZCksXG4gICAgICAoeCkgPT4geC5zb3J0KCksXG4gICAgICBNYXRjaGVyLnRvRXF1YWwsXG4gICAgICAoKSA9PiBbd2hhbGVBZGRyLCBhZGRyQi52YWx1ZSwgYWRkckMudmFsdWVdLnNvcnQoKVxuICAgIF0sXG4gICAgW1xuICAgICAgXCJleHBvcnRLZXlcIixcbiAgICAgICgpID0+IHN3YXBjaGFpbi5leHBvcnRLZXkodXNlciwgcGFzc3dkLCBhZGRyQi52YWx1ZSksXG4gICAgICAoeCkgPT4geCxcbiAgICAgIE1hdGNoZXIudG9NYXRjaCxcbiAgICAgICgpID0+IC9Qcml2YXRlS2V5LVxcdyovXG4gICAgXSxcbiAgICBbXG4gICAgICBcImV4cG9ydFwiLFxuICAgICAgKCkgPT5cbiAgICAgICAgc3dhcGNoYWluLmV4cG9ydChcbiAgICAgICAgICB1c2VyLFxuICAgICAgICAgIHBhc3N3ZCxcbiAgICAgICAgICBcIkFYXCIgKyBhZGRyQi52YWx1ZS5zdWJzdHJpbmcoMSksXG4gICAgICAgICAgbmV3IEJOKDEwKSxcbiAgICAgICAgICBcIkFYQ1wiXG4gICAgICAgICksXG4gICAgICAoeCkgPT4geCxcbiAgICAgIE1hdGNoZXIudG9UaHJvdyxcbiAgICAgICgpID0+IFwiY291bGRuJ3QgdW5tYXJzaGFsIGFuIGFyZ3VtZW50XCJcbiAgICBdLFxuICAgIFtcbiAgICAgIFwiaW1wb3J0XCIsXG4gICAgICAoKSA9PiBzd2FwY2hhaW4uaW1wb3J0KHVzZXIsIHBhc3N3ZCwgYWRkckIudmFsdWUsIFwiQ29yZVwiKSxcbiAgICAgICh4KSA9PiB4LFxuICAgICAgTWF0Y2hlci50b1Rocm93LFxuICAgICAgKCkgPT4gXCJwcm9ibGVtIGlzc3VpbmcgdHJhbnNhY3Rpb246IG5vIGltcG9ydCBpbnB1dHNcIlxuICAgIF0sXG4gICAgW1xuICAgICAgXCJjcmVhdGVGaXhlZFwiLFxuICAgICAgKCkgPT5cbiAgICAgICAgc3dhcGNoYWluLmNyZWF0ZUZpeGVkQ2FwQXNzZXQodXNlciwgcGFzc3dkLCBcIlNvbWUgQ29pblwiLCBcIlNDQ1wiLCAwLCBbXG4gICAgICAgICAgeyBhZGRyZXNzOiB3aGFsZUFkZHIsIGFtb3VudDogXCIxMDAwMFwiIH1cbiAgICAgICAgXSksXG4gICAgICAoeCkgPT4geCxcbiAgICAgIE1hdGNoZXIuR2V0LFxuICAgICAgKCkgPT4gYXNzZXRcbiAgICBdLFxuICAgIFtcbiAgICAgIFwiY3JlYXRlVmFyXCIsXG4gICAgICAoKSA9PlxuICAgICAgICBzd2FwY2hhaW4uY3JlYXRlVmFyaWFibGVDYXBBc3NldCh1c2VyLCBwYXNzd2QsIFwiU29tZSBDb2luXCIsIFwiU0NDXCIsIDAsIFtcbiAgICAgICAgICB7IG1pbnRlcnM6IFt3aGFsZUFkZHJdLCB0aHJlc2hvbGQ6IDEgfVxuICAgICAgICBdKSxcbiAgICAgICh4KSA9PiB4LFxuICAgICAgTWF0Y2hlci5HZXQsXG4gICAgICAoKSA9PiBhc3NldFxuICAgIF0sXG4gICAgW1xuICAgICAgXCJtaW50XCIsXG4gICAgICAoKSA9PlxuICAgICAgICBzd2FwY2hhaW4ubWludCh1c2VyLCBwYXNzd2QsIDE1MDAsIGFzc2V0LnZhbHVlLCBhZGRyQi52YWx1ZSwgW3doYWxlQWRkcl0pLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLnRvVGhyb3csXG4gICAgICAoKSA9PiBcImNvdWxkbid0IHVubWFyc2hhbCBhbiBhcmd1bWVudFwiXG4gICAgXSxcbiAgICBbXG4gICAgICBcImdldFR4XCIsXG4gICAgICAoKSA9PiBzd2FwY2hhaW4uZ2V0VHgodHgudmFsdWUpLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLnRvTWF0Y2gsXG4gICAgICAoKSA9PiAvXFx3Ky9cbiAgICBdLFxuICAgIFtcbiAgICAgIFwiZ2V0VHhTdGF0dXNcIixcbiAgICAgICgpID0+IHN3YXBjaGFpbi5nZXRUeFN0YXR1cyh0eC52YWx1ZSksXG4gICAgICAoeCkgPT4geCxcbiAgICAgIE1hdGNoZXIudG9CZSxcbiAgICAgICgpID0+IFwiUHJvY2Vzc2luZ1wiXG4gICAgXSxcbiAgICBbXG4gICAgICBcImdldEFzc2V0RGVzY1wiLFxuICAgICAgKCkgPT4gc3dhcGNoYWluLmdldEFzc2V0RGVzY3JpcHRpb24oYXNzZXQudmFsdWUpLFxuICAgICAgKHgpID0+IFt4Lm5hbWUsIHguc3ltYm9sXSxcbiAgICAgIE1hdGNoZXIudG9FcXVhbCxcbiAgICAgICgpID0+IFtcIlNvbWUgQ29pblwiLCBcIlNDQ1wiXVxuICAgIF1cbiAgXVxuXG4gIGNyZWF0ZVRlc3RzKHRlc3RzX3NwZWMpXG59KSJdfQ==