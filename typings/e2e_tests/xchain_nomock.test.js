"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const e2etestlib_1 = require("./e2etestlib");
const api_1 = require("src/apis/keystore/api");
const bn_js_1 = __importDefault(require("bn.js"));
describe("XChain", () => {
    let tx = { value: "" };
    let asset = { value: "" };
    let addrB = { value: "" };
    let addrC = { value: "" };
    const axia = (0, e2etestlib_1.getAxia)();
    const xchain = axia.XChain();
    const keystore = new api_1.KeystoreAPI(axia);
    const user = "axiaJsXChainUser";
    const passwd = "axiaJsP1ssw4rd";
    const badUser = "asdfasdfsa";
    const badPass = "pass";
    const memo = "hello world";
    const whaleAddr = "X-custom18jma8ppw3nhx5r4ap8clazz0dps7rv5u9xde7p";
    const key = "PrivateKey-ewoqjP7PxY4yr3iLTpLisriqt94hdyDFNgchSxGGztUrTXtNN";
    // test_name        response_promise                            resp_fn          matcher           expected_value/obtained_value
    const tests_spec = [
        [
            "createUser",
            () => keystore.createUser(user, passwd),
            (x) => x,
            e2etestlib_1.Matcher.toBe,
            () => true
        ],
        [
            "createaddrB",
            () => xchain.createAddress(user, passwd),
            (x) => x,
            e2etestlib_1.Matcher.Get,
            () => addrB
        ],
        [
            "createaddrB",
            () => xchain.createAddress(user, passwd),
            (x) => x,
            e2etestlib_1.Matcher.Get,
            () => addrC
        ],
        [
            "incorrectUser",
            () => xchain.send(badUser, passwd, "AVAX", 10, addrB.value, [addrC.value], addrB.value, memo),
            (x) => x,
            e2etestlib_1.Matcher.toThrow,
            () => `problem retrieving user "${badUser}": incorrect password for user "${badUser}"`
        ],
        [
            "incorrectPass",
            () => xchain.send(user, badPass, "AVAX", 10, addrB.value, [addrC.value], addrB.value, memo),
            (x) => x,
            e2etestlib_1.Matcher.toThrow,
            () => `problem retrieving user "${user}": incorrect password for user "${user}"`
        ],
        [
            "getBalance",
            () => xchain.getBalance(whaleAddr, "AVAX"),
            (x) => x.balance,
            e2etestlib_1.Matcher.toBe,
            () => "300000000000000000"
        ],
        [
            "getBalance2",
            () => xchain.getBalance(whaleAddr, "AXC"),
            (x) => x.utxoIDs[0].txID,
            e2etestlib_1.Matcher.toBe,
            () => "BUuypiq2wyuLMvyhzFXcPyxPMCgSp7eeDohhQRqTChoBjKziC"
        ],
        [
            "importKey",
            () => xchain.importKey(user, passwd, key),
            (x) => x,
            e2etestlib_1.Matcher.toBe,
            () => whaleAddr
        ],
        [
            "send",
            () => xchain.send(user, passwd, "AVAX", 10, addrB.value, [whaleAddr], whaleAddr, memo),
            (x) => x.txID,
            e2etestlib_1.Matcher.Get,
            () => tx
        ],
        [
            "sendMultiple",
            () => xchain.sendMultiple(user, passwd, [
                { assetID: "AVAX", amount: 10, to: addrB.value },
                { assetID: "AVAX", amount: 20, to: addrC.value }
            ], [whaleAddr], whaleAddr, memo),
            (x) => x.txID,
            e2etestlib_1.Matcher.Get,
            () => tx
        ],
        [
            "listAddrs",
            () => xchain.listAddresses(user, passwd),
            (x) => x.sort(),
            e2etestlib_1.Matcher.toEqual,
            () => [whaleAddr, addrB.value, addrC.value].sort()
        ],
        [
            "exportKey",
            () => xchain.exportKey(user, passwd, addrB.value),
            (x) => x,
            e2etestlib_1.Matcher.toMatch,
            () => /PrivateKey-\w*/
        ],
        [
            "export",
            () => xchain.export(user, passwd, "C" + addrB.value.substring(1), new bn_js_1.default(10), "AXC"),
            (x) => x,
            e2etestlib_1.Matcher.toThrow,
            () => "couldn't unmarshal an argument"
        ],
        [
            "import",
            () => xchain.import(user, passwd, addrB.value, "P"),
            (x) => x,
            e2etestlib_1.Matcher.toThrow,
            () => "problem issuing transaction: no import inputs"
        ],
        [
            "createFixed",
            () => xchain.createFixedCapAsset(user, passwd, "Some Coin", "SCC", 0, [
                { address: whaleAddr, amount: "10000" }
            ]),
            (x) => x,
            e2etestlib_1.Matcher.Get,
            () => asset
        ],
        [
            "createVar",
            () => xchain.createVariableCapAsset(user, passwd, "Some Coin", "SCC", 0, [
                { minters: [whaleAddr], threshold: 1 }
            ]),
            (x) => x,
            e2etestlib_1.Matcher.Get,
            () => asset
        ],
        [
            "mint",
            () => xchain.mint(user, passwd, 1500, asset.value, addrB.value, [whaleAddr]),
            (x) => x,
            e2etestlib_1.Matcher.toThrow,
            () => "couldn't unmarshal an argument"
        ],
        [
            "getTx",
            () => xchain.getTx(tx.value),
            (x) => x,
            e2etestlib_1.Matcher.toMatch,
            () => /\w+/
        ],
        [
            "getTxStatus",
            () => xchain.getTxStatus(tx.value),
            (x) => x,
            e2etestlib_1.Matcher.toBe,
            () => "Processing"
        ],
        [
            "getAssetDesc",
            () => xchain.getAssetDescription(asset.value),
            (x) => [x.name, x.symbol],
            e2etestlib_1.Matcher.toEqual,
            () => ["Some Coin", "SCC"]
        ]
    ];
    (0, e2etestlib_1.createTests)(tests_spec);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieGNoYWluX25vbW9jay50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vZTJlX3Rlc3RzL3hjaGFpbl9ub21vY2sudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLDZDQUE0RDtBQUM1RCwrQ0FBbUQ7QUFDbkQsa0RBQXNCO0FBRXRCLFFBQVEsQ0FBQyxRQUFRLEVBQUUsR0FBUyxFQUFFO0lBQzVCLElBQUksRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFBO0lBQ3RCLElBQUksS0FBSyxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFBO0lBQ3pCLElBQUksS0FBSyxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFBO0lBQ3pCLElBQUksS0FBSyxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFBO0lBRXpCLE1BQU0sSUFBSSxHQUFHLElBQUEsb0JBQU8sR0FBRSxDQUFBO0lBQ3RCLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQTtJQUM1QixNQUFNLFFBQVEsR0FBRyxJQUFJLGlCQUFXLENBQUMsSUFBSSxDQUFDLENBQUE7SUFFdEMsTUFBTSxJQUFJLEdBQVcsa0JBQWtCLENBQUE7SUFDdkMsTUFBTSxNQUFNLEdBQVcsZ0JBQWdCLENBQUE7SUFDdkMsTUFBTSxPQUFPLEdBQVcsWUFBWSxDQUFBO0lBQ3BDLE1BQU0sT0FBTyxHQUFXLE1BQU0sQ0FBQTtJQUM5QixNQUFNLElBQUksR0FBVyxhQUFhLENBQUE7SUFDbEMsTUFBTSxTQUFTLEdBQVcsaURBQWlELENBQUE7SUFDM0UsTUFBTSxHQUFHLEdBQ1AsOERBQThELENBQUE7SUFFaEUsZ0lBQWdJO0lBQ2hJLE1BQU0sVUFBVSxHQUFRO1FBQ3RCO1lBQ0UsWUFBWTtZQUNaLEdBQUcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQztZQUN2QyxD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Q0gsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUN4RSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNSLG9CQUFPLENBQUMsT0FBTztZQUNmLEdBQUcsRUFBRSxDQUFDLGdDQUFnQztTQUN2QztRQUNEO1lBQ0UsT0FBTztZQUNQLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQztZQUM1QixDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNSLG9CQUFPLENBQUMsT0FBTztZQUNmLEdBQUcsRUFBRSxDQUFDLEtBQUs7U0FDWjtRQUNEO1lBQ0UsYUFBYTtZQUNiLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQztZQUNsQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNSLG9CQUFPLENBQUMsSUFBSTtZQUNaLEdBQUcsRUFBRSxDQUFDLFlBQVk7U0FDbkI7UUFDRDtZQUNFLGNBQWM7WUFDZCxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQztZQUM3QyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUM7WUFDekIsb0JBQU8sQ0FBQyxPQUFPO1lBQ2YsR0FBRyxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUsS0FBSyxDQUFDO1NBQzNCO0tBQ0YsQ0FBQTtJQUVELElBQUEsd0JBQVcsRUFBQyxVQUFVLENBQUMsQ0FBQTtBQUN6QixDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldEF4aWEsIGNyZWF0ZVRlc3RzLCBNYXRjaGVyIH0gZnJvbSBcIi4vZTJldGVzdGxpYlwiXG5pbXBvcnQgeyBLZXlzdG9yZUFQSSB9IGZyb20gXCJzcmMvYXBpcy9rZXlzdG9yZS9hcGlcIlxuaW1wb3J0IEJOIGZyb20gXCJibi5qc1wiXG5cbmRlc2NyaWJlKFwiWENoYWluXCIsICgpOiB2b2lkID0+IHtcbiAgbGV0IHR4ID0geyB2YWx1ZTogXCJcIiB9XG4gIGxldCBhc3NldCA9IHsgdmFsdWU6IFwiXCIgfVxuICBsZXQgYWRkckIgPSB7IHZhbHVlOiBcIlwiIH1cbiAgbGV0IGFkZHJDID0geyB2YWx1ZTogXCJcIiB9XG5cbiAgY29uc3QgYXhpYSA9IGdldEF4aWEoKVxuICBjb25zdCB4Y2hhaW4gPSBheGlhLlhDaGFpbigpXG4gIGNvbnN0IGtleXN0b3JlID0gbmV3IEtleXN0b3JlQVBJKGF4aWEpXG5cbiAgY29uc3QgdXNlcjogc3RyaW5nID0gXCJheGlhSnNYQ2hhaW5Vc2VyXCJcbiAgY29uc3QgcGFzc3dkOiBzdHJpbmcgPSBcImF4aWFKc1Axc3N3NHJkXCJcbiAgY29uc3QgYmFkVXNlcjogc3RyaW5nID0gXCJhc2RmYXNkZnNhXCJcbiAgY29uc3QgYmFkUGFzczogc3RyaW5nID0gXCJwYXNzXCJcbiAgY29uc3QgbWVtbzogc3RyaW5nID0gXCJoZWxsbyB3b3JsZFwiXG4gIGNvbnN0IHdoYWxlQWRkcjogc3RyaW5nID0gXCJYLWN1c3RvbTE4am1hOHBwdzNuaHg1cjRhcDhjbGF6ejBkcHM3cnY1dTl4ZGU3cFwiXG4gIGNvbnN0IGtleTogc3RyaW5nID1cbiAgICBcIlByaXZhdGVLZXktZXdvcWpQN1B4WTR5cjNpTFRwTGlzcmlxdDk0aGR5REZOZ2NoU3hHR3p0VXJUWHROTlwiXG5cbiAgLy8gdGVzdF9uYW1lICAgICAgICByZXNwb25zZV9wcm9taXNlICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BfZm4gICAgICAgICAgbWF0Y2hlciAgICAgICAgICAgZXhwZWN0ZWRfdmFsdWUvb2J0YWluZWRfdmFsdWVcbiAgY29uc3QgdGVzdHNfc3BlYzogYW55ID0gW1xuICAgIFtcbiAgICAgIFwiY3JlYXRlVXNlclwiLFxuICAgICAgKCkgPT4ga2V5c3RvcmUuY3JlYXRlVXNlcih1c2VyLCBwYXNzd2QpLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLnRvQmUsXG4gICAgICAoKSA9PiB0cnVlXG4gICAgXSxcbiAgICBbXG4gICAgICBcImNyZWF0ZWFkZHJCXCIsXG4gICAgICAoKSA9PiB4Y2hhaW4uY3JlYXRlQWRkcmVzcyh1c2VyLCBwYXNzd2QpLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLkdldCxcbiAgICAgICgpID0+IGFkZHJCXG4gICAgXSxcbiAgICBbXG4gICAgICBcImNyZWF0ZWFkZHJCXCIsXG4gICAgICAoKSA9PiB4Y2hhaW4uY3JlYXRlQWRkcmVzcyh1c2VyLCBwYXNzd2QpLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLkdldCxcbiAgICAgICgpID0+IGFkZHJDXG4gICAgXSxcbiAgICBbXG4gICAgICBcImluY29ycmVjdFVzZXJcIixcbiAgICAgICgpID0+XG4gICAgICAgIHhjaGFpbi5zZW5kKFxuICAgICAgICAgIGJhZFVzZXIsXG4gICAgICAgICAgcGFzc3dkLFxuICAgICAgICAgIFwiQVZBWFwiLFxuICAgICAgICAgIDEwLFxuICAgICAgICAgIGFkZHJCLnZhbHVlLFxuICAgICAgICAgIFthZGRyQy52YWx1ZV0sXG4gICAgICAgICAgYWRkckIudmFsdWUsXG4gICAgICAgICAgbWVtb1xuICAgICAgICApLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLnRvVGhyb3csXG4gICAgICAoKSA9PiBgcHJvYmxlbSByZXRyaWV2aW5nIHVzZXIgXCIke2JhZFVzZXJ9XCI6IGluY29ycmVjdCBwYXNzd29yZCBmb3IgdXNlciBcIiR7YmFkVXNlcn1cImBcbiAgICBdLFxuICAgIFtcbiAgICAgIFwiaW5jb3JyZWN0UGFzc1wiLFxuICAgICAgKCkgPT5cbiAgICAgICAgeGNoYWluLnNlbmQoXG4gICAgICAgICAgdXNlcixcbiAgICAgICAgICBiYWRQYXNzLFxuICAgICAgICAgIFwiQVZBWFwiLFxuICAgICAgICAgIDEwLFxuICAgICAgICAgIGFkZHJCLnZhbHVlLFxuICAgICAgICAgIFthZGRyQy52YWx1ZV0sXG4gICAgICAgICAgYWRkckIudmFsdWUsXG4gICAgICAgICAgbWVtb1xuICAgICAgICApLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLnRvVGhyb3csXG4gICAgICAoKSA9PiBgcHJvYmxlbSByZXRyaWV2aW5nIHVzZXIgXCIke3VzZXJ9XCI6IGluY29ycmVjdCBwYXNzd29yZCBmb3IgdXNlciBcIiR7dXNlcn1cImBcbiAgICBdLFxuICAgIFtcbiAgICAgIFwiZ2V0QmFsYW5jZVwiLFxuICAgICAgKCkgPT4geGNoYWluLmdldEJhbGFuY2Uod2hhbGVBZGRyLCBcIkFWQVhcIiksXG4gICAgICAoeCkgPT4geC5iYWxhbmNlLFxuICAgICAgTWF0Y2hlci50b0JlLFxuICAgICAgKCkgPT4gXCIzMDAwMDAwMDAwMDAwMDAwMDBcIlxuICAgIF0sXG4gICAgW1xuICAgICAgXCJnZXRCYWxhbmNlMlwiLFxuICAgICAgKCkgPT4geGNoYWluLmdldEJhbGFuY2Uod2hhbGVBZGRyLCBcIkFYQ1wiKSxcbiAgICAgICh4KSA9PiB4LnV0eG9JRHNbMF0udHhJRCxcbiAgICAgIE1hdGNoZXIudG9CZSxcbiAgICAgICgpID0+IFwiQlV1eXBpcTJ3eXVMTXZ5aHpGWGNQeXhQTUNnU3A3ZWVEb2hoUVJxVENob0JqS3ppQ1wiXG4gICAgXSxcbiAgICBbXG4gICAgICBcImltcG9ydEtleVwiLFxuICAgICAgKCkgPT4geGNoYWluLmltcG9ydEtleSh1c2VyLCBwYXNzd2QsIGtleSksXG4gICAgICAoeCkgPT4geCxcbiAgICAgIE1hdGNoZXIudG9CZSxcbiAgICAgICgpID0+IHdoYWxlQWRkclxuICAgIF0sXG4gICAgW1xuICAgICAgXCJzZW5kXCIsXG4gICAgICAoKSA9PlxuICAgICAgICB4Y2hhaW4uc2VuZChcbiAgICAgICAgICB1c2VyLFxuICAgICAgICAgIHBhc3N3ZCxcbiAgICAgICAgICBcIkFWQVhcIixcbiAgICAgICAgICAxMCxcbiAgICAgICAgICBhZGRyQi52YWx1ZSxcbiAgICAgICAgICBbd2hhbGVBZGRyXSxcbiAgICAgICAgICB3aGFsZUFkZHIsXG4gICAgICAgICAgbWVtb1xuICAgICAgICApLFxuICAgICAgKHgpID0+IHgudHhJRCxcbiAgICAgIE1hdGNoZXIuR2V0LFxuICAgICAgKCkgPT4gdHhcbiAgICBdLFxuICAgIFtcbiAgICAgIFwic2VuZE11bHRpcGxlXCIsXG4gICAgICAoKSA9PlxuICAgICAgICB4Y2hhaW4uc2VuZE11bHRpcGxlKFxuICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgcGFzc3dkLFxuICAgICAgICAgIFtcbiAgICAgICAgICAgIHsgYXNzZXRJRDogXCJBVkFYXCIsIGFtb3VudDogMTAsIHRvOiBhZGRyQi52YWx1ZSB9LFxuICAgICAgICAgICAgeyBhc3NldElEOiBcIkFWQVhcIiwgYW1vdW50OiAyMCwgdG86IGFkZHJDLnZhbHVlIH1cbiAgICAgICAgICBdLFxuICAgICAgICAgIFt3aGFsZUFkZHJdLFxuICAgICAgICAgIHdoYWxlQWRkcixcbiAgICAgICAgICBtZW1vXG4gICAgICAgICksXG4gICAgICAoeCkgPT4geC50eElELFxuICAgICAgTWF0Y2hlci5HZXQsXG4gICAgICAoKSA9PiB0eFxuICAgIF0sXG4gICAgW1xuICAgICAgXCJsaXN0QWRkcnNcIixcbiAgICAgICgpID0+IHhjaGFpbi5saXN0QWRkcmVzc2VzKHVzZXIsIHBhc3N3ZCksXG4gICAgICAoeCkgPT4geC5zb3J0KCksXG4gICAgICBNYXRjaGVyLnRvRXF1YWwsXG4gICAgICAoKSA9PiBbd2hhbGVBZGRyLCBhZGRyQi52YWx1ZSwgYWRkckMudmFsdWVdLnNvcnQoKVxuICAgIF0sXG4gICAgW1xuICAgICAgXCJleHBvcnRLZXlcIixcbiAgICAgICgpID0+IHhjaGFpbi5leHBvcnRLZXkodXNlciwgcGFzc3dkLCBhZGRyQi52YWx1ZSksXG4gICAgICAoeCkgPT4geCxcbiAgICAgIE1hdGNoZXIudG9NYXRjaCxcbiAgICAgICgpID0+IC9Qcml2YXRlS2V5LVxcdyovXG4gICAgXSxcbiAgICBbXG4gICAgICBcImV4cG9ydFwiLFxuICAgICAgKCkgPT5cbiAgICAgICAgeGNoYWluLmV4cG9ydChcbiAgICAgICAgICB1c2VyLFxuICAgICAgICAgIHBhc3N3ZCxcbiAgICAgICAgICBcIkNcIiArIGFkZHJCLnZhbHVlLnN1YnN0cmluZygxKSxcbiAgICAgICAgICBuZXcgQk4oMTApLFxuICAgICAgICAgIFwiQVhDXCJcbiAgICAgICAgKSxcbiAgICAgICh4KSA9PiB4LFxuICAgICAgTWF0Y2hlci50b1Rocm93LFxuICAgICAgKCkgPT4gXCJjb3VsZG4ndCB1bm1hcnNoYWwgYW4gYXJndW1lbnRcIlxuICAgIF0sXG4gICAgW1xuICAgICAgXCJpbXBvcnRcIixcbiAgICAgICgpID0+IHhjaGFpbi5pbXBvcnQodXNlciwgcGFzc3dkLCBhZGRyQi52YWx1ZSwgXCJQXCIpLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLnRvVGhyb3csXG4gICAgICAoKSA9PiBcInByb2JsZW0gaXNzdWluZyB0cmFuc2FjdGlvbjogbm8gaW1wb3J0IGlucHV0c1wiXG4gICAgXSxcbiAgICBbXG4gICAgICBcImNyZWF0ZUZpeGVkXCIsXG4gICAgICAoKSA9PlxuICAgICAgICB4Y2hhaW4uY3JlYXRlRml4ZWRDYXBBc3NldCh1c2VyLCBwYXNzd2QsIFwiU29tZSBDb2luXCIsIFwiU0NDXCIsIDAsIFtcbiAgICAgICAgICB7IGFkZHJlc3M6IHdoYWxlQWRkciwgYW1vdW50OiBcIjEwMDAwXCIgfVxuICAgICAgICBdKSxcbiAgICAgICh4KSA9PiB4LFxuICAgICAgTWF0Y2hlci5HZXQsXG4gICAgICAoKSA9PiBhc3NldFxuICAgIF0sXG4gICAgW1xuICAgICAgXCJjcmVhdGVWYXJcIixcbiAgICAgICgpID0+XG4gICAgICAgIHhjaGFpbi5jcmVhdGVWYXJpYWJsZUNhcEFzc2V0KHVzZXIsIHBhc3N3ZCwgXCJTb21lIENvaW5cIiwgXCJTQ0NcIiwgMCwgW1xuICAgICAgICAgIHsgbWludGVyczogW3doYWxlQWRkcl0sIHRocmVzaG9sZDogMSB9XG4gICAgICAgIF0pLFxuICAgICAgKHgpID0+IHgsXG4gICAgICBNYXRjaGVyLkdldCxcbiAgICAgICgpID0+IGFzc2V0XG4gICAgXSxcbiAgICBbXG4gICAgICBcIm1pbnRcIixcbiAgICAgICgpID0+XG4gICAgICAgIHhjaGFpbi5taW50KHVzZXIsIHBhc3N3ZCwgMTUwMCwgYXNzZXQudmFsdWUsIGFkZHJCLnZhbHVlLCBbd2hhbGVBZGRyXSksXG4gICAgICAoeCkgPT4geCxcbiAgICAgIE1hdGNoZXIudG9UaHJvdyxcbiAgICAgICgpID0+IFwiY291bGRuJ3QgdW5tYXJzaGFsIGFuIGFyZ3VtZW50XCJcbiAgICBdLFxuICAgIFtcbiAgICAgIFwiZ2V0VHhcIixcbiAgICAgICgpID0+IHhjaGFpbi5nZXRUeCh0eC52YWx1ZSksXG4gICAgICAoeCkgPT4geCxcbiAgICAgIE1hdGNoZXIudG9NYXRjaCxcbiAgICAgICgpID0+IC9cXHcrL1xuICAgIF0sXG4gICAgW1xuICAgICAgXCJnZXRUeFN0YXR1c1wiLFxuICAgICAgKCkgPT4geGNoYWluLmdldFR4U3RhdHVzKHR4LnZhbHVlKSxcbiAgICAgICh4KSA9PiB4LFxuICAgICAgTWF0Y2hlci50b0JlLFxuICAgICAgKCkgPT4gXCJQcm9jZXNzaW5nXCJcbiAgICBdLFxuICAgIFtcbiAgICAgIFwiZ2V0QXNzZXREZXNjXCIsXG4gICAgICAoKSA9PiB4Y2hhaW4uZ2V0QXNzZXREZXNjcmlwdGlvbihhc3NldC52YWx1ZSksXG4gICAgICAoeCkgPT4gW3gubmFtZSwgeC5zeW1ib2xdLFxuICAgICAgTWF0Y2hlci50b0VxdWFsLFxuICAgICAgKCkgPT4gW1wiU29tZSBDb2luXCIsIFwiU0NDXCJdXG4gICAgXVxuICBdXG5cbiAgY3JlYXRlVGVzdHModGVzdHNfc3BlYylcbn0pIl19